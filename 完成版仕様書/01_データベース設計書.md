# ã¾ã”ã“ã‚ã‚µãƒãƒ¼ãƒˆ - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸

**ä½œæˆæ—¥**: 2026-01-09
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ç¢ºå®š

---

## ğŸ“‹ ç›®æ¬¡

1. [ERå›³ï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–¢ä¿‚å›³ï¼‰](#erå›³)
2. [ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§](#ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§)
3. [ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©è©³ç´°](#ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©è©³ç´°)
4. [ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ](#ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ)
5. [ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿åˆæœŸå€¤](#ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿åˆæœŸå€¤)

---

## ERå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ã¾ã”ã“ã‚ã‚µãƒãƒ¼ãƒˆ ERå›³                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚    users     â”‚
                                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                                    â”‚ id (PK)      â”‚
                                    â”‚ email        â”‚
                                    â”‚ password     â”‚
                                    â”‚ user_type    â”‚
                                    â”‚ partner_id   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ concierge_id â”‚â—„â”€â”€â”€â”€â”    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
                                           â”‚             â”‚    â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
                              â”‚            â”‚            â”‚â”‚    â”‚
                              â–¼            â–¼            â–¼â”‚    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   partners   â”‚              â”‚  concierges  â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id (PK)      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ id (PK)      â”‚
                    â”‚ name         â”‚  partner_id  â”‚ name         â”‚
                    â”‚ phone        â”‚              â”‚ phone        â”‚
                    â”‚ email        â”‚              â”‚ email        â”‚
                    â”‚ address      â”‚              â”‚ partner_id   â”‚
                    â”‚ status       â”‚              â”‚ status       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                            â”‚
                           â”‚                            â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
          â”‚                â”‚                â”‚           â”‚
          â–¼                â–¼                â–¼           â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚  customers   â”‚ â”‚    cases     â”‚ â”‚   services   â”‚   â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
   â”‚ id (PK)      â”‚ â”‚ id (PK)      â”‚ â”‚ id (PK)      â”‚   â”‚
   â”‚ name         â”‚ â”‚ customer_id  â”‚â—„â”‚ name         â”‚   â”‚
   â”‚ phone        â”‚ â”‚ partner_id   â”‚ â”‚ price        â”‚   â”‚
   â”‚ email        â”‚ â”‚ concierge_id â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚ address      â”‚ â”‚ service_id   â”‚â—„â”˜
   â”‚ partner_id   â”‚ â”‚ status       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ scheduled_at â”‚
          â”‚         â”‚ completed_at â”‚
          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   reports    â”‚
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                    â”‚ id (PK)      â”‚
                    â”‚ case_id (FK) â”‚
                    â”‚ content      â”‚
                    â”‚ photos       â”‚
                    â”‚ submitted_at â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚service_types â”‚support_types â”‚    drafts    â”‚                                    â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                                    â”‚
â”‚ id (PK)      â”‚ id (PK)      â”‚ id (PK)      â”‚                                    â”‚
â”‚ name         â”‚ name         â”‚ entity_type  â”‚                                    â”‚
â”‚ code         â”‚ code         â”‚ entity_id    â”‚                                    â”‚
â”‚ description  â”‚ description  â”‚ user_id      â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

| # | ãƒ†ãƒ¼ãƒ–ãƒ«å | èª¬æ˜ | ãƒ¬ã‚³ãƒ¼ãƒ‰ç›®å®‰ |
|---|-----------|------|-------------|
| 1 | users | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ | 100-500 |
| 2 | partners | ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼åŠ ç›Ÿåº— | 50-200 |
| 3 | concierges | ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ï¼ˆç¾å ´æ‹…å½“è€…ï¼‰ | 100-500 |
| 4 | customers | ãŠå®¢æ§˜ | 1,000-10,000 |
| 5 | cases | æ¡ˆä»¶ | 5,000-50,000 |
| 6 | reports | ä½œæ¥­å ±å‘Š | 5,000-50,000 |
| 7 | services | ã‚µãƒ¼ãƒ“ã‚¹ | 50-100 |
| 8 | service_types | ã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥ï¼ˆãƒã‚¹ã‚¿ï¼‰ | 10-30 |
| 9 | support_types | ã‚µãƒãƒ¼ãƒˆç¨®åˆ¥ï¼ˆãƒã‚¹ã‚¿ï¼‰ | 10-30 |
| 10 | drafts | ä¸‹æ›¸ããƒ‡ãƒ¼ã‚¿ | 100-1,000 |
| 11 | password_reset_tokens | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ | 0-100 |
| 12 | case_concierges | æ¡ˆä»¶-ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ« | 5,000-50,000 |

---

## ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©è©³ç´°

### 1. usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| email | VARCHAR(255) | NO | - | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| password_hash | VARCHAR(255) | NO | - | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ï¼ˆbcryptï¼‰ |
| user_type | ENUM | NO | - | 'admin', 'operator', 'partner', 'concierge' |
| partner_id | BIGINT | YES | NULL | ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼IDï¼ˆpartner/conciergeã®å ´åˆï¼‰ |
| concierge_id | BIGINT | YES | NULL | ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥IDï¼ˆconciergeã®å ´åˆï¼‰ |
| name | VARCHAR(100) | NO | - | è¡¨ç¤ºå |
| status | ENUM | NO | 'active' | 'active', 'inactive', 'suspended' |
| last_login_at | TIMESTAMP | YES | NULL | æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ™‚ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_email (email)
- INDEX idx_user_type (user_type)
- INDEX idx_partner_id (partner_id)
- INDEX idx_status (status)

**å¤–éƒ¨ã‚­ãƒ¼**:
- partner_id â†’ partners(id) ON DELETE SET NULL
- concierge_id â†’ concierges(id) ON DELETE SET NULL

---

### 2. partnersï¼ˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼åŠ ç›Ÿåº—ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| name | VARCHAR(100) | NO | - | åº—èˆ—å |
| representative_name | VARCHAR(100) | YES | NULL | ä»£è¡¨è€…å |
| phone | VARCHAR(20) | NO | - | é›»è©±ç•ªå· |
| email | VARCHAR(255) | NO | - | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| postal_code | VARCHAR(10) | YES | NULL | éƒµä¾¿ç•ªå· |
| prefecture | VARCHAR(20) | YES | NULL | éƒ½é“åºœçœŒ |
| city | VARCHAR(50) | YES | NULL | å¸‚åŒºç”ºæ‘ |
| address | VARCHAR(255) | YES | NULL | ç•ªåœ°ä»¥é™ |
| business_hours_start | TIME | YES | NULL | å–¶æ¥­é–‹å§‹æ™‚é–“ |
| business_hours_end | TIME | YES | NULL | å–¶æ¥­çµ‚äº†æ™‚é–“ |
| holidays | VARCHAR(255) | YES | NULL | å®šä¼‘æ—¥ |
| status | ENUM | NO | 'active' | 'active', 'inactive', 'suspended' |
| contract_start_date | DATE | YES | NULL | å¥‘ç´„é–‹å§‹æ—¥ |
| contract_end_date | DATE | YES | NULL | å¥‘ç´„çµ‚äº†æ—¥ |
| notes | TEXT | YES | NULL | å‚™è€ƒ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_email (email)
- INDEX idx_status (status)
- INDEX idx_prefecture (prefecture)

---

### 3. conciergesï¼ˆã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| partner_id | BIGINT | NO | - | æ‰€å±ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ID |
| name | VARCHAR(100) | NO | - | æ°å |
| furigana | VARCHAR(100) | YES | NULL | ãµã‚ŠãŒãª |
| phone | VARCHAR(20) | NO | - | é›»è©±ç•ªå· |
| email | VARCHAR(255) | NO | - | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| birth_date | DATE | YES | NULL | ç”Ÿå¹´æœˆæ—¥ |
| postal_code | VARCHAR(10) | YES | NULL | éƒµä¾¿ç•ªå· |
| prefecture | VARCHAR(20) | YES | NULL | éƒ½é“åºœçœŒ |
| city | VARCHAR(50) | YES | NULL | å¸‚åŒºç”ºæ‘ |
| address | VARCHAR(255) | YES | NULL | ç•ªåœ°ä»¥é™ |
| employment_type | ENUM | NO | 'full_time' | 'full_time', 'contract', 'part_time', 'temporary' |
| hire_date | DATE | NO | - | å…¥ç¤¾æ—¥ |
| status | ENUM | NO | 'active' | 'active', 'inactive' |
| notes | TEXT | YES | NULL | å‚™è€ƒ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_partner_id (partner_id)
- UNIQUE INDEX idx_email (email)
- INDEX idx_status (status)

**å¤–éƒ¨ã‚­ãƒ¼**:
- partner_id â†’ partners(id) ON DELETE CASCADE

---

### 4. customersï¼ˆãŠå®¢æ§˜ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| partner_id | BIGINT | YES | NULL | ç™»éŒ²ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ID |
| name_sei | VARCHAR(50) | NO | - | å§“ |
| name_mei | VARCHAR(50) | NO | - | å |
| furigana_sei | VARCHAR(50) | YES | NULL | ãµã‚ŠãŒãªï¼ˆå§“ï¼‰ |
| furigana_mei | VARCHAR(50) | YES | NULL | ãµã‚ŠãŒãªï¼ˆåï¼‰ |
| phone | VARCHAR(20) | NO | - | é›»è©±ç•ªå· |
| phone_sub | VARCHAR(20) | YES | NULL | é›»è©±ç•ªå·ï¼ˆã‚µãƒ–ï¼‰ |
| email | VARCHAR(255) | YES | NULL | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| postal_code | VARCHAR(10) | YES | NULL | éƒµä¾¿ç•ªå· |
| prefecture | VARCHAR(20) | NO | - | éƒ½é“åºœçœŒ |
| city | VARCHAR(50) | NO | - | å¸‚åŒºç”ºæ‘ |
| address | VARCHAR(255) | NO | - | ç•ªåœ°ä»¥é™ |
| building | VARCHAR(100) | YES | NULL | å»ºç‰©åãƒ»éƒ¨å±‹ç•ªå· |
| birth_date | DATE | YES | NULL | ç”Ÿå¹´æœˆæ—¥ |
| gender | ENUM | YES | NULL | 'male', 'female', 'other' |
| emergency_contact_name | VARCHAR(100) | YES | NULL | ç·Šæ€¥é€£çµ¡å…ˆï¼ˆåå‰ï¼‰ |
| emergency_contact_phone | VARCHAR(20) | YES | NULL | ç·Šæ€¥é€£çµ¡å…ˆï¼ˆé›»è©±ï¼‰ |
| emergency_contact_relationship | VARCHAR(50) | YES | NULL | ç·Šæ€¥é€£çµ¡å…ˆï¼ˆç¶šæŸ„ï¼‰ |
| notes | TEXT | YES | NULL | å‚™è€ƒ |
| status | ENUM | NO | 'active' | 'active', 'inactive' |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_partner_id (partner_id)
- INDEX idx_phone (phone)
- INDEX idx_name (name_sei, name_mei)
- INDEX idx_prefecture (prefecture)
- INDEX idx_status (status)

**å¤–éƒ¨ã‚­ãƒ¼**:
- partner_id â†’ partners(id) ON DELETE SET NULL

---

### 5. casesï¼ˆæ¡ˆä»¶ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| case_number | VARCHAR(20) | NO | - | æ¡ˆä»¶ç•ªå·ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| customer_id | BIGINT | NO | - | ãŠå®¢æ§˜ID |
| partner_id | BIGINT | NO | - | ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ID |
| service_id | BIGINT | YES | NULL | ã‚µãƒ¼ãƒ“ã‚¹ID |
| support_type_id | BIGINT | YES | NULL | ã‚µãƒãƒ¼ãƒˆç¨®åˆ¥ID |
| status | ENUM | NO | 'draft' | ä¸‹è¨˜å‚ç…§ |
| title | VARCHAR(200) | YES | NULL | æ¡ˆä»¶ã‚¿ã‚¤ãƒˆãƒ« |
| description | TEXT | YES | NULL | ä¾é ¼å†…å®¹è©³ç´° |
| requested_date | DATE | YES | NULL | å¸Œæœ›æ—¥ |
| requested_time_start | TIME | YES | NULL | å¸Œæœ›æ™‚é–“ï¼ˆé–‹å§‹ï¼‰ |
| requested_time_end | TIME | YES | NULL | å¸Œæœ›æ™‚é–“ï¼ˆçµ‚äº†ï¼‰ |
| scheduled_date | DATE | YES | NULL | è¨ªå•äºˆå®šæ—¥ |
| scheduled_time_start | TIME | YES | NULL | è¨ªå•äºˆå®šæ™‚é–“ï¼ˆé–‹å§‹ï¼‰ |
| scheduled_time_end | TIME | YES | NULL | è¨ªå•äºˆå®šæ™‚é–“ï¼ˆçµ‚äº†ï¼‰ |
| completed_at | TIMESTAMP | YES | NULL | å®Œäº†æ—¥æ™‚ |
| estimated_duration | INT | YES | NULL | äºˆå®šä½œæ¥­æ™‚é–“ï¼ˆåˆ†ï¼‰ |
| actual_duration | INT | YES | NULL | å®Ÿç¸¾ä½œæ¥­æ™‚é–“ï¼ˆåˆ†ï¼‰ |
| estimated_price | DECIMAL(10,0) | YES | NULL | è¦‹ç©é‡‘é¡ |
| actual_price | DECIMAL(10,0) | YES | NULL | å®Ÿç¸¾é‡‘é¡ |
| visit_address | VARCHAR(255) | YES | NULL | è¨ªå•å…ˆä½æ‰€ï¼ˆãŠå®¢æ§˜ä½æ‰€ã¨ç•°ãªã‚‹å ´åˆï¼‰ |
| priority | ENUM | NO | 'normal' | 'low', 'normal', 'high', 'urgent' |
| notes | TEXT | YES | NULL | å‚™è€ƒ |
| created_by | BIGINT | YES | NULL | ä½œæˆè€…ID |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å®šç¾©**:
| å€¤ | èª¬æ˜ |
|----|------|
| draft | ä¸‹æ›¸ã |
| pending | ç¢ºèªå¾…ã¡ |
| confirmed | ç¢ºå®š |
| assigned | ã‚¢ã‚µã‚¤ãƒ³æ¸ˆã¿ |
| in_progress | å¯¾å¿œä¸­ |
| completed | ä½œæ¥­å®Œäº† |
| reported | å ±å‘Šæ¸ˆã¿ |
| cancelled | ã‚­ãƒ£ãƒ³ã‚»ãƒ« |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_case_number (case_number)
- INDEX idx_customer_id (customer_id)
- INDEX idx_partner_id (partner_id)
- INDEX idx_status (status)
- INDEX idx_scheduled_date (scheduled_date)
- INDEX idx_created_at (created_at)

**å¤–éƒ¨ã‚­ãƒ¼**:
- customer_id â†’ customers(id) ON DELETE RESTRICT
- partner_id â†’ partners(id) ON DELETE RESTRICT
- service_id â†’ services(id) ON DELETE SET NULL
- support_type_id â†’ support_types(id) ON DELETE SET NULL
- created_by â†’ users(id) ON DELETE SET NULL

---

### 6. case_conciergesï¼ˆæ¡ˆä»¶-ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| case_id | BIGINT | NO | - | æ¡ˆä»¶ID |
| concierge_id | BIGINT | NO | - | ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ID |
| is_primary | BOOLEAN | NO | FALSE | ä¸»æ‹…å½“ãƒ•ãƒ©ã‚° |
| assigned_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ã‚¢ã‚µã‚¤ãƒ³æ—¥æ™‚ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_case_concierge (case_id, concierge_id)
- INDEX idx_concierge_id (concierge_id)

**å¤–éƒ¨ã‚­ãƒ¼**:
- case_id â†’ cases(id) ON DELETE CASCADE
- concierge_id â†’ concierges(id) ON DELETE CASCADE

---

### 7. reportsï¼ˆä½œæ¥­å ±å‘Šï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| case_id | BIGINT | NO | - | æ¡ˆä»¶ID |
| concierge_id | BIGINT | NO | - | å ±å‘Šè€…ï¼ˆã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ï¼‰ID |
| status | ENUM | NO | 'draft' | 'draft', 'submitted', 'approved' |
| visit_date | DATE | NO | - | è¨ªå•æ—¥ |
| visit_time_start | TIME | YES | NULL | è¨ªå•é–‹å§‹æ™‚é–“ |
| visit_time_end | TIME | YES | NULL | è¨ªå•çµ‚äº†æ™‚é–“ |
| work_duration | INT | YES | NULL | ä½œæ¥­æ™‚é–“ï¼ˆåˆ†ï¼‰ |
| work_content | TEXT | YES | NULL | ä½œæ¥­å†…å®¹ |
| customer_condition | TEXT | YES | NULL | ãŠå®¢æ§˜ã®æ§˜å­ |
| next_action | TEXT | YES | NULL | æ¬¡å›å¯¾å¿œäº‹é … |
| notes | TEXT | YES | NULL | å‚™è€ƒ |
| submitted_at | TIMESTAMP | YES | NULL | æå‡ºæ—¥æ™‚ |
| approved_at | TIMESTAMP | YES | NULL | æ‰¿èªæ—¥æ™‚ |
| approved_by | BIGINT | YES | NULL | æ‰¿èªè€…ID |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_case_id (case_id)
- INDEX idx_concierge_id (concierge_id)
- INDEX idx_status (status)
- INDEX idx_visit_date (visit_date)

**å¤–éƒ¨ã‚­ãƒ¼**:
- case_id â†’ cases(id) ON DELETE CASCADE
- concierge_id â†’ concierges(id) ON DELETE RESTRICT
- approved_by â†’ users(id) ON DELETE SET NULL

---

### 8. report_photosï¼ˆå ±å‘Šå†™çœŸï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| report_id | BIGINT | NO | - | å ±å‘ŠID |
| file_path | VARCHAR(500) | NO | - | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ |
| file_name | VARCHAR(255) | NO | - | ãƒ•ã‚¡ã‚¤ãƒ«å |
| file_size | INT | NO | - | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºï¼ˆbytesï¼‰ |
| mime_type | VARCHAR(100) | NO | - | MIMEã‚¿ã‚¤ãƒ— |
| sort_order | INT | NO | 0 | è¡¨ç¤ºé † |
| caption | VARCHAR(255) | YES | NULL | ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_report_id (report_id)

**å¤–éƒ¨ã‚­ãƒ¼**:
- report_id â†’ reports(id) ON DELETE CASCADE

---

### 9. servicesï¼ˆã‚µãƒ¼ãƒ“ã‚¹ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| service_type_id | BIGINT | YES | NULL | ã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥ID |
| name | VARCHAR(100) | NO | - | ã‚µãƒ¼ãƒ“ã‚¹å |
| description | TEXT | YES | NULL | èª¬æ˜ |
| base_price | DECIMAL(10,0) | YES | NULL | åŸºæœ¬æ–™é‡‘ |
| duration_minutes | INT | YES | NULL | æ¨™æº–ä½œæ¥­æ™‚é–“ï¼ˆåˆ†ï¼‰ |
| status | ENUM | NO | 'active' | 'active', 'inactive' |
| sort_order | INT | NO | 0 | è¡¨ç¤ºé † |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_service_type_id (service_type_id)
- INDEX idx_status (status)

**å¤–éƒ¨ã‚­ãƒ¼**:
- service_type_id â†’ service_types(id) ON DELETE SET NULL

---

### 10. service_typesï¼ˆã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥ãƒã‚¹ã‚¿ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| code | VARCHAR(20) | NO | - | ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| name | VARCHAR(100) | NO | - | ç¨®åˆ¥å |
| description | TEXT | YES | NULL | èª¬æ˜ |
| status | ENUM | NO | 'active' | 'active', 'inactive' |
| sort_order | INT | NO | 0 | è¡¨ç¤ºé † |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_code (code)

---

### 11. support_typesï¼ˆã‚µãƒãƒ¼ãƒˆç¨®åˆ¥ãƒã‚¹ã‚¿ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| code | VARCHAR(20) | NO | - | ã‚³ãƒ¼ãƒ‰ï¼ˆãƒ¦ãƒ‹ãƒ¼ã‚¯ï¼‰ |
| name | VARCHAR(100) | NO | - | ç¨®åˆ¥å |
| description | TEXT | YES | NULL | èª¬æ˜ |
| status | ENUM | NO | 'active' | 'active', 'inactive' |
| sort_order | INT | NO | 0 | è¡¨ç¤ºé † |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- UNIQUE INDEX idx_code (code)

---

### 12. draftsï¼ˆä¸‹æ›¸ãï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| user_id | BIGINT | NO | - | ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |
| entity_type | VARCHAR(50) | NO | - | ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç¨®åˆ¥ï¼ˆ'case', 'report', 'customer'ç­‰ï¼‰ |
| entity_id | BIGINT | YES | NULL | ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£IDï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®å ´åˆï¼‰ |
| form_data | JSON | NO | - | ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆJSONï¼‰ |
| expires_at | TIMESTAMP | NO | - | æœ‰åŠ¹æœŸé™ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |
| updated_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_user_entity (user_id, entity_type, entity_id)
- INDEX idx_expires_at (expires_at)

**å¤–éƒ¨ã‚­ãƒ¼**:
- user_id â†’ users(id) ON DELETE CASCADE

---

### 13. password_reset_tokensï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ï¼‰

| ã‚«ãƒ©ãƒ å | ãƒ‡ãƒ¼ã‚¿å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---------|------|-----------|------|
| id | BIGINT | NO | AUTO_INCREMENT | ä¸»ã‚­ãƒ¼ |
| user_id | BIGINT | NO | - | ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |
| token | VARCHAR(255) | NO | - | ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆãƒãƒƒã‚·ãƒ¥åŒ–ï¼‰ |
| expires_at | TIMESTAMP | NO | - | æœ‰åŠ¹æœŸé™ |
| used_at | TIMESTAMP | YES | NULL | ä½¿ç”¨æ—¥æ™‚ |
| created_at | TIMESTAMP | NO | CURRENT_TIMESTAMP | ä½œæˆæ—¥æ™‚ |

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- PRIMARY KEY (id)
- INDEX idx_token (token)
- INDEX idx_user_id (user_id)

**å¤–éƒ¨ã‚­ãƒ¼**:
- user_id â†’ users(id) ON DELETE CASCADE

---

## ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é‡è¦–ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

| ãƒ†ãƒ¼ãƒ–ãƒ« | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å | ã‚«ãƒ©ãƒ  | ç”¨é€” |
|---------|--------------|-------|------|
| cases | idx_search | (partner_id, status, scheduled_date) | æ¡ˆä»¶ä¸€è¦§æ¤œç´¢ |
| cases | idx_concierge_schedule | (scheduled_date, status) | ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« |
| customers | idx_search | (partner_id, name_sei, name_mei) | é¡§å®¢æ¤œç´¢ |
| reports | idx_pending | (status, visit_date) | æœªå ±å‘Šä¸€è¦§ |

---

## ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿åˆæœŸå€¤

### service_typesï¼ˆã‚µãƒ¼ãƒ“ã‚¹ç¨®åˆ¥ï¼‰

| code | name |
|------|------|
| HOUSEKEEPING | å®¶äº‹ä»£è¡Œ |
| SHOPPING | è²·ã„ç‰©ä»£è¡Œ |
| ESCORT | å¤–å‡ºä»˜ãæ·»ã„ |
| HOSPITAL | é€šé™¢ä»˜ãæ·»ã„ |
| CLEANING | æƒé™¤ |
| COOKING | èª¿ç† |
| OTHER | ãã®ä»– |

### support_typesï¼ˆã‚µãƒãƒ¼ãƒˆç¨®åˆ¥ï¼‰

| code | name |
|------|------|
| REGULAR | å®šæœŸã‚µãƒãƒ¼ãƒˆ |
| ONETIME | å˜ç™ºã‚µãƒãƒ¼ãƒˆ |
| EMERGENCY | ç·Šæ€¥å¯¾å¿œ |
| CONSULTATION | ç›¸è«‡ã®ã¿ |

---

## è£œè¶³äº‹é …

### æ–‡å­—ã‚³ãƒ¼ãƒ‰
- UTF-8 (utf8mb4) ã‚’ä½¿ç”¨
- çµµæ–‡å­—å¯¾å¿œ

### ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³
- Asia/Tokyo (JST) ã‚’ä½¿ç”¨
- TIMESTAMP ã¯ UTC ã§ä¿å­˜ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å¤‰æ›

### è«–ç†å‰Šé™¤
- æœ¬è¨­è¨ˆã§ã¯ç‰©ç†å‰Šé™¤ã‚’æ¡ç”¨
- å¿…è¦ã«å¿œã˜ã¦ deleted_at ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã—ã¦è«–ç†å‰Šé™¤ã«å¤‰æ›´å¯èƒ½

### ç›£æŸ»ãƒ­ã‚°
- é‡è¦ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆcases, reportsï¼‰ã¯åˆ¥é€”ç›£æŸ»ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¤œè¨

---

**ä½œæˆè€…**: Claude Code
**æœ€çµ‚æ›´æ–°**: 2026-01-09
