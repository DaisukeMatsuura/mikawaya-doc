# アカウント発行

ステータス: 作業中
ユーザー種別: 管理者
概要: 新規アカウントの発行
機能番号: A-006
画面種別: フォーム

# アカウント発行（モーダル）

![スクリーンショット 2025-12-10 10.25.57.png](%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E7%99%BA%E8%A1%8C/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2025-12-10_10.25.57.png)

## Figmaデザイン

[https://www.figma.com/design/mjSOs02H4hqf9kIsiFlm4e/%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3?node-id=381-44244&t=h1plxwLq1DP5umKv-0](https://www.figma.com/design/mjSOs02H4hqf9kIsiFlm4e/%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3?node-id=381-44244&t=h1plxwLq1DP5umKv-0)

---

## 🎯 画面の目的

管理者がシステム利用者（オペレーター、パートナー加盟店、コンシェルジュ）のアカウントを新規発行する。

---

## 📊 表示データ項目

### STEP1：アカウント種別選択

| 項目名 | データ型 | 必須 | 備考 |
| --- | --- | --- | --- |
| アカウント種別 | Enum | ◯ | オペレーター / パートナー加盟店 / コンシェルジュ |

### STEP2：基本情報入力

| 項目名 | データ型 | 必須 | 備考 |
| --- | --- | --- | --- |
| 所属店舗 | Enum | △ | パートナー加盟店/コンシェルジュ選択時のみ表示 |
| 姓 | String | ◯ |  |
| 名 | String | ◯ |  |
| 姓（カタカナ） | String | ◯ |  |
| 名（カタカナ） | String | ◯ |  |
| メールアドレス | String | ◯ | ログインID兼用、重複不可 |

---

## ⚙️ 機能・操作

| 要素 | 操作 | 動作 |
| --- | --- | --- |
| アカウント種別セレクト | 選択 | 種別を選択すると基本情報入力フォームが表示される |
| 姓・名入力欄 | 入力 | 必須バリデーション |
| 姓・名（カタカナ）入力欄 | 入力 | カタカナのみ許可 |
| メールアドレス入力欄 | 入力 | メール形式バリデーション、重複チェック |
| キャンセルボタン | クリック | モーダルを閉じる（入力内容は破棄） |
| 作成ボタン（STEP1） | クリック | 基本情報入力へ進む |
| 発行ボタン（STEP2） | クリック | アカウント作成、初期パスワードをメール送信 |

---

## 🔄 状態パターン

| 状態 | 表示内容 |
| --- | --- |
| 初期表示 | アカウント種別セレクトのみ表示 |
| 種別選択後 | 基本情報入力フォームを表示 |
| バリデーションエラー | 該当項目を赤枠 + エラーメッセージ |
| メール重複エラー | 「このメールアドレスは既に登録されています。」 |
| 発行処理中 | ボタンをローディング表示 |
| 発行完了 | モーダルを閉じる、一覧を更新、トースト通知「アカウントを発行しました」 |

---

## 🔐 権限

| ユーザー種別 | 閲覧 | 実行 |
| --- | --- | --- |
| 管理者 | ◯ | ◯ |
| オペレータ | ✕ | ✕ |
| パートナー | ✕ | ✕ |
| コンシェルジュ | ✕ | ✕ |

---

## 📝 備考

- API: `POST /api/admin/accounts`
- 初期パスワードはシステムが自動生成（ランダム12文字、英数字混合）
- アカウント発行後、入力されたメールアドレス宛に以下を送信：
    - ログインURL
    - メールアドレス（ログインID）
    - 初期パスワード
    - 初回ログイン時にパスワード変更を促すメッセージ
- 新規アカウントのステータスは「アクティブ」で作成
- **初回ログイン時はパスワード変更を強制する**（変更しないとダッシュボードへ遷移不可）

---

## 📧 送信メール内容

| 項目 | 内容 |
| --- | --- |
| 件名 | 【まごころサポート】アカウント発行のお知らせ |
| 本文 | ログインURL、メールアドレス、初期パスワード、パスワード変更のお願い |

### メール本文例

```
○○様

まごころサポートのアカウントが発行されました。

■ログイン情報
ログインURL：https://xxxxx.com/login
メールアドレス：sample@magokoro.co.jp
初期パスワード：xxxxxxxxxxxx

※セキュリティのため、初回ログイン後にパスワードを変更してください。

ご不明な点がございましたら、管理者までお問い合わせください。

```

---

## ⚠️ デザイン修正依頼

- パートナー加盟店/コンシェルジュ選択時、「所属店舗」の選択項目を追加する