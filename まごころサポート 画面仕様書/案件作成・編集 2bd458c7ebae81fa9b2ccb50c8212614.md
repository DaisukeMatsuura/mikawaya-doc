# 案件作成・編集

ステータス: 作業中
ユーザー種別: パートナー加盟店
概要: 案件の登録・編集
機能番号: W-001
画面種別: モーダル

# パートナー加盟店 案件作成（モーダル）

![スクリーンショット 2025-12-10 22.43.43.png](%E6%A1%88%E4%BB%B6%E4%BD%9C%E6%88%90%E3%83%BB%E7%B7%A8%E9%9B%86%202bd4-2614/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2025-12-10_22.43.43.png)

## Figmaデザイン

[https://www.figma.com/design/mjSOs02H4hqf9kIsiFlm4e/%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3?node-id=550-38160&t=q71JbxSPjtZZ7HBO-0](https://www.figma.com/design/mjSOs02H4hqf9kIsiFlm4e/%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3?node-id=550-38160&t=q71JbxSPjtZZ7HBO-0)

---

## 🎯 画面の目的

パートナー加盟店が新規のサポート依頼（案件）を作成する。

---

## 📊 表示データ項目

### 基本情報

| 項目名 | データ型 | 必須 | 備考 |
| --- | --- | --- | --- |
| 担当店舗 | Enum | ◯ | セレクト（自店舗で固定 or 選択） |
| お客様名 | Enum | ◯ | セレクト（顧客マスタから選択、検索可能） |
| コールセンターからの取次事項 | String | - | テキストエリア、ツールチップあり |

### 事前情報

| 項目名 | データ型 | 必須 | 備考 |
| --- | --- | --- | --- |
| 訪問予定日 | Date | - | 日付選択 |
| 訪問予定時間 | Time | - | セレクトまたは入力 |
| 受注経路 | Enum | - | セレクト |
| 受注可否 | Enum | ◯ | デフォルト：確認中 |
| サポート種別 | Enum | - | セレクト |
| サービス内容 | Enum | - | セレクト |
| 見積もり金額 | Number | - |  |
| 受注者（コンシェルジュ） | Enum | - | セレクト + 「コンシェルジュ追加」ボタン |
| 送客内容店舗確認済チェック | Boolean | - | 「確認しました」 |
| 送客内容コンシェルジュ確認済み | Boolean | - | 「確認しました」 |
| 訪問までの対応履歴 | String | - | テキストエリア、ツールチップあり |

---

## ⚙️ 機能・操作

| 要素 | 操作 | 動作 |
| --- | --- | --- |
| 担当店舗セレクト | 選択 | 店舗を選択（自店舗で固定の場合あり） |
| お客様名セレクト | 選択 | 顧客を選択（検索可能） |
| 取次事項テキストエリア | 入力 | 自由入力 |
| 訪問予定日 | 選択 | カレンダーから日付選択 |
| 訪問予定時間 | 選択/入力 | 時間を選択または入力 |
| 受注経路セレクト | 選択 | 受注経路を選択 |
| 受注可否セレクト | 選択 | ステータスを選択 |
| サポート種別セレクト | 選択 | サポート種別を選択 |
| サービス内容セレクト | 選択 | サービス内容を選択 |
| 見積もり金額入力欄 | 入力 | 数値のみ許可 |
| 受注者セレクト | 選択 | コンシェルジュを選択 |
| コンシェルジュ追加ボタン | クリック | コンシェルジュ選択を追加（複数対応） |
| 確認チェックボックス | クリック | チェックON/OFF |
| 対応履歴テキストエリア | 入力 | 自由入力 |
| キャンセルボタン | クリック | モーダルを閉じる（入力内容は破棄） |
| 下書き保存ボタン | クリック | 下書きとして保存 |
| 保存ボタン | クリック | 案件を作成 |

---

## 🔄 状態パターン

| 状態 | 表示内容 |
| --- | --- |
| 新規作成モード | フォーム空欄（担当店舗は自店舗で固定） |
| コピー作成モード | コピー元の内容を表示 |
| バリデーションエラー | 該当項目を赤枠 + エラーメッセージ |
| 処理中 | ボタンをローディング表示 |
| 保存完了 | モーダルを閉じる、一覧を更新、トースト通知「案件を作成しました」 |
| 下書き保存完了 | モーダルを閉じる、トースト通知「下書きを保存しました」 |

---

## 🔐 権限

| ユーザー種別 | 閲覧 | 実行 |
| --- | --- | --- |
| 管理者 | ◯ | ◯ |
| オペレータ | ◯ | ◯ |
| パートナー | ◯ | ◯ |
| コンシェルジュ | ✕ | ✕ |

---

## 📝 備考

- API: `POST /api/partner/cases`（新規作成）
- API: `POST /api/partner/cases/draft`（下書き保存）
- 案件Noは保存時に自動採番
- 受注可否のデフォルトは「確認中」
- パートナーが作成する場合、担当店舗は自店舗で固定
- 「コンシェルジュ追加」で複数のコンシェルジュを割り当て可能
- オペレーター版と比べて、サポート種別・サービス内容・見積もり金額など詳細項目が追加

---

## オペレーター版との違い

| 項目 | オペレーター | パートナー |
| --- | --- | --- |
| 担当店舗 | 全店舗から選択可 | 自店舗で固定 |
| サポート種別 | なし | あり |
| サービス内容 | なし | あり |
| 見積もり金額 | なし | あり |
| コンシェルジュ追加 | なし | あり（複数対応） |
| 確認チェック | なし | あり（店舗・コンシェルジュ） |

---

## ⚠️ デザイン修正依頼

- 「送客内容店舗確認済チェック」「送客内容コンシェルジュ確認済み」のチェックボックスを削除
- これらは画面を閲覧したタイミングで自動的にONになる仕様に変更（バックエンドで管理）